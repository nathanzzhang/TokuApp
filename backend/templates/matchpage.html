{% extends 'base.html'%}

{%block head %}

{% endblock %}

extends profile.html 

{% block content %}
    <h1> Matches </h1>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="">T≈çku</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
            <a class="nav-item nav-link" href="/profile">Profile <span class="sr-only">(current)</span></a>
            <a class="nav-item nav-link" href="/match">Matches</a>
            <a class="nav-item nav-link" href="/friends">Friends</a>
            <a class="nav-item nav-link" href="/faq">About</a>
            <a class="nav-item nav-link" href="/logout">Logout</a>
            </div>
        </div>
    </nav>
    <div id="matchingPage">
        <div id = "matchingDescription">
            <h3> 
                Hello! Congratulations on getting matched!
            </h3>
            <h3>
                Here you'll see people who you matched with. Take a look at what language you will help them with and which language they will help you with!
                If you click on the "Add Friend" button, you will be able to communicate with them! 
            </h3>
        </div>
        <div id="tblofmatches">
            <table style ="width:100%" id="match_table">
                <tr>
                    <th>Name</th>
                    <th>Match Language</th>
                    <th>Add Friend!</th>
                </tr>
                {% for username, language in matches.items() %}
                <tr>
                    <div id="row">
                    <td>{{username}}</td>
                    <td>{{language}}</td>
                    <td>
                       <form name="{{username}}" method="POST" action='/match'>
                            
                            <button class="button" value={{username}} id="user" name="{{username}}" onclick='add()'>Add Friend</button>
                        </form>
                    </td>
                    </div>
                </tr>
                {% endfor %}
            </table>
        </div>
        <script>
            function addFriend(username) {
                var x = document.getElementById(username);
                if(x.innerHTML == "Add Friend")
                {
                    x.innerHTML = "Friend Added!";
                }
                $.getJSON('/match', add_friend(username));
                alert("test");
                /*window.location.href = "/match/" + username;
                $.post("/match", {
                    create_username: JSON.stringify(username)
                }, function(err, req, resp){
                    window.location.href = "/match/" + resp["responseJSON"];
                });
                */
            }
            function add(){
                $.ajax({
                type: "POST",
                url: "/match",
                contentType: "application/json",
                data: JSON.stringify($('#user').val()),
                dataType: "json",
                success: function(response) {
                    console.log(response);
                },
                error: function(err) {
                    console.log(err);
                }
                });
                
            }
        </script>
        
    </div>
{% endblock%}
